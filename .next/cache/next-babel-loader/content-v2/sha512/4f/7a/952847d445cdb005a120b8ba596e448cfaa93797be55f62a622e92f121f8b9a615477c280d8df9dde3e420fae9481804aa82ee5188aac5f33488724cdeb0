{"ast":null,"code":"import _regeneratorRuntime from \"/Users/bbhavnasi/Desktop/ReactJS-Apps/App1/nextjs-blog/node_modules/@babel/runtime/regenerator\";\nimport _slicedToArray from \"/Users/bbhavnasi/Desktop/ReactJS-Apps/App1/nextjs-blog/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"/Users/bbhavnasi/Desktop/ReactJS-Apps/App1/nextjs-blog/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nexport var SET_DATA = \"SET_DATA\";\nexport var FAILURE = \"FAILURE\";\nimport axios from \"axios\";\nimport { mapData } from \"../utils\";\nexport var getData = function getData(options) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n      var unit, lang, key, query, params, geoCode, forecast, geocode, _geoCode, data, forecastResponse, payload;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              unit = options.unit, lang = options.lang, key = options.key, query = options.query;\n              params = {\n                appid: key,\n                lang: lang,\n                units: unit,\n                q: query\n              };\n              geoCode = \"http://api.openweathermap.org/geo/1.0/direct?q=\".concat(query, \"&&limit=1&appid=\").concat(key);\n              forecast = \"//api.openweathermap.org/data/2.5/onecall\";\n              _context.next = 6;\n              return axios.get(geoCode);\n\n            case 6:\n              geocode = _context.sent;\n              console.log(geocode.data);\n              _geoCode = _slicedToArray(geoCode, 1), data = _geoCode[0];\n              params.lat = geocode[0].lat;\n              params.lon = geoCode[0].lon;\n              _context.prev = 11;\n              _context.next = 14;\n              return axios.get(forecast, {\n                params: params\n              });\n\n            case 14:\n              forecastResponse = _context.sent;\n              _context.next = 17;\n              return mapData(forecastResponse, lang);\n\n            case 17:\n              payload = _context.sent;\n              dispatch({\n                type: SET_DATA,\n                payload: payload\n              });\n              _context.next = 25;\n              break;\n\n            case 21:\n              _context.prev = 21;\n              _context.t0 = _context[\"catch\"](11);\n              console.error(_context.t0.message);\n              dispatch({\n                type: FAILURE,\n                payload: {\n                  error: _context.t0.message || _context.t0\n                }\n              });\n\n            case 25:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[11, 21]]);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};","map":{"version":3,"sources":["/Users/bbhavnasi/Desktop/ReactJS-Apps/App1/nextjs-blog/src/redux/action.js"],"names":["SET_DATA","FAILURE","axios","mapData","getData","options","dispatch","unit","lang","key","query","params","appid","units","q","geoCode","forecast","get","geocode","console","log","data","lat","lon","forecastResponse","payload","type","error","message"],"mappings":";;;AAAA,OAAO,IAAMA,QAAQ,GAAG,UAAjB;AACP,OAAO,IAAMC,OAAO,GAAG,SAAhB;AACP,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,UAAxB;AAEA,OAAO,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACC,OAAD;AAAA;AAAA,wEAAa,iBAAOC,QAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAC1BC,cAAAA,IAD0B,GACCF,OADD,CAC1BE,IAD0B,EACpBC,IADoB,GACCH,OADD,CACpBG,IADoB,EACdC,GADc,GACCJ,OADD,CACdI,GADc,EACTC,KADS,GACCL,OADD,CACTK,KADS;AAE5BC,cAAAA,MAF4B,GAEnB;AACbC,gBAAAA,KAAK,EAAEH,GADM;AAEbD,gBAAAA,IAAI,EAAJA,IAFa;AAGbK,gBAAAA,KAAK,EAAEN,IAHM;AAIbO,gBAAAA,CAAC,EAAEJ;AAJU,eAFmB;AAS5BK,cAAAA,OAT4B,4DASgCL,KAThC,6BASwDD,GATxD;AAU5BO,cAAAA,QAV4B,GAUjB,2CAViB;AAAA;AAAA,qBAYZd,KAAK,CAACe,GAAN,CAAUF,OAAV,CAZY;;AAAA;AAY5BG,cAAAA,OAZ4B;AAalCC,cAAAA,OAAO,CAACC,GAAR,CAAYF,OAAO,CAACG,IAApB;AAbkC,wCAenBN,OAfmB,MAe3BM,IAf2B;AAiBlCV,cAAAA,MAAM,CAACW,GAAP,GAAaJ,OAAO,CAAC,CAAD,CAAP,CAAWI,GAAxB;AACAX,cAAAA,MAAM,CAACY,GAAP,GAAaR,OAAO,CAAC,CAAD,CAAP,CAAWQ,GAAxB;AAlBkC;AAAA;AAAA,qBAqBDrB,KAAK,CAACe,GAAN,CAAUD,QAAV,EAAoB;AAAEL,gBAAAA,MAAM,EAANA;AAAF,eAApB,CArBC;;AAAA;AAqB1Ba,cAAAA,gBArB0B;AAAA;AAAA,qBAuBVrB,OAAO,CAACqB,gBAAD,EAAmBhB,IAAnB,CAvBG;;AAAA;AAuB1BiB,cAAAA,OAvB0B;AAyBhCnB,cAAAA,QAAQ,CAAC;AACPoB,gBAAAA,IAAI,EAAE1B,QADC;AAEPyB,gBAAAA,OAAO,EAAEA;AAFF,eAAD,CAAR;AAzBgC;AAAA;;AAAA;AAAA;AAAA;AA8BhCN,cAAAA,OAAO,CAACQ,KAAR,CAAc,YAAMC,OAApB;AACAtB,cAAAA,QAAQ,CAAC;AAAEoB,gBAAAA,IAAI,EAAEzB,OAAR;AAAiBwB,gBAAAA,OAAO,EAAE;AAAEE,kBAAAA,KAAK,EAAE,YAAMC,OAAN;AAAT;AAA1B,eAAD,CAAR;;AA/BgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAb;;AAAA;AAAA;AAAA;AAAA;AAAA,CAAhB","sourcesContent":["export const SET_DATA = \"SET_DATA\";\nexport const FAILURE = \"FAILURE\";\nimport axios from \"axios\";\nimport { mapData } from \"../utils\";\n\nexport const getData = (options) => async (dispatch) => {\n  const { unit, lang, key, query } = options;\n  const params = {\n    appid: key,\n    lang,\n    units: unit,\n    q: query,\n  };\n\n  const geoCode = `http://api.openweathermap.org/geo/1.0/direct?q=${query}&&limit=1&appid=${key}`;\n  const forecast = \"//api.openweathermap.org/data/2.5/onecall\";\n\n  const geocode = await axios.get(geoCode);\n  console.log(geocode.data);\n\n  const [data] = geoCode;\n\n  params.lat = geocode[0].lat;\n  params.lon = geoCode[0].lon;\n\n  try {\n    const forecastResponse = await axios.get(forecast, { params });\n\n    const payload = await mapData(forecastResponse, lang);\n\n    dispatch({\n      type: SET_DATA,\n      payload: payload,\n    });\n  } catch (error) {\n    console.error(error.message);\n    dispatch({ type: FAILURE, payload: { error: error.message || error } });\n  }\n};\n"]},"metadata":{},"sourceType":"module"}